if(NOT MSVC)
  if(APPLE)
    set(CMAKE_MACOSX_RPATH ON)
  endif()
  set(CMAKE_INSTALL_RPATH_USE_LINK_PATH ON)
  list(FIND CMAKE_PLATFORM_IMPLICIT_LINK_DIRECTORIES "${CMAKE_INSTALL_PREFIX}/${CMAKE_INSTALL_LIBDIR}" isSystemDir)
  if("${isSystemDir}" STREQUAL "-1")
    set(CMAKE_INSTALL_RPATH ${CMAKE_INSTALL_PREFIX}/${CMAKE_INSTALL_LIBDIR})
  endif()
endif()
